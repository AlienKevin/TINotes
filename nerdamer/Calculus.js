"undefined"!=typeof module&&"undefined"==typeof nerdamer&&(nerdamer=require("./nerdamer.core.js"),require("./Algebra.js")),function(){"use strict";var e=nerdamer.getCore(),i=e.PARSER,r=e.Frac,n=e.Settings,t=e.Utils.isSymbol,a=e.groups.FN,s=e.Symbol,o=e.Utils.text,l=e.Utils.inBrackets,p=e.Utils.isInt,u=e.Utils.format,c=e.Utils.even,f=e.Utils.evaluate,g=e.groups.N,m=e.groups.S,w=(a=e.groups.FN,e.groups.PL),d=e.groups.CP,v=e.groups.CB,y=e.groups.EX,b=e.groups.P,h="log",L="abs",_="sqrt",U="sin",k="cos",q="tan",S="sec",x="csc",T="cot",C="asin",N="acos",I="atan",A="asec",M="acsc",E="acot",F="sinh",R="cosh",D="tanh",V="csch",B="sech",P="coth",O="asech",H="acsch",Q="acoth";function j(e){this.message=e||""}j.prototype=new Error,s.prototype.hasIntegral=function(){return this.containsFunction("integrate")},s.prototype.fnTransform=function(){var e,r=this.args[0];if(this.isLinear())switch(this.fname){case F:e=i.parse(u("(e^({0})-e^(-({0})))/2",r));break;case R:e=i.parse(u("(e^({0})+e^(-({0})))/2",r));break;case D:e=i.parse(u("(e^({0})-e^(-({0})))/(e^({0})+e^(-({0})))",r));break;case q:e=i.parse(u("sin({0})/cos({0})",r));break;case x:e=i.parse(u("1/sin({0})",r));break;case S:e=i.parse(u("1/cos({0})",r));break;default:e=this}else if(this.power.equals(2))switch(this.fname){case U:e=i.parse(u("1/2-cos(2*({0}))/2",r));break;case k:e=i.parse(u("1/2+cos(2*({0}))/2",r));break;case q:e=i.parse(u("sin({0})^2/cos({0})^2",r));break;case R:e=i.parse(u("1/2+cosh(2*({0}))/2",r));break;case F:e=i.parse(u("-1/2+cosh(2*({0}))/2",r));break;case D:e=i.parse(u("(1+cosh(2*({0})))/(-1+cosh(2*({0})))",r));break;case S:e=i.parse(u("(1-cos(2*({0})))/(1+cos(2*({0})))+1",r));break;default:e=this}else e=this.fname===S?i.parse(u("1/cos({0})^({1})",this.args[0],this.power)):this.fname===x?i.parse(u("1/sin({0})^({1})",this.args[0],this.power)):this.fname===q?this.power.lessThan(0)?i.parse(u("cos({0})^(-({1}))/sin({0})^({1})",this.args[0],this.power.negate())):i.parse(u("sin({0})^({1})/cos({0})^({1})",this.args[0],this.power)):this.fname===U&&this.power.lessThan(0)?i.parse(u("csc({0})^(-({1}))",this.args[0],this.power.negate())):this.fname===k&&this.power.lessThan(0)?i.parse(u("sec({0})^(-({1}))",this.args[0],this.power.negate())):this.fname===U&&this.power.equals(3)?i.parse(u("(3*sin({0})-sin(3*({0})))/4",this.args[0])):this.fname===k&&this.power.equals(3)?i.parse(u("(cos(3*({0}))+3*cos({0}))/4",this.args[0])):this;return e},e.Expression.prototype.hasIntegral=function(){return this.symbol.hasIntegral()},e.Utils.toCommonDenominator=function(r){if(r.isComposite()&&r.isLinear()){var n=new s(r.multiplier),t=new s(1),a=new s(0);return r.each(function(e){t=i.multiply(t,e.getDenom())},!0),r.each(function(e){var r=e.getNum(),n=e.getDenom(),s=i.multiply(r,i.divide(t.clone(),n));a=i.add(a,s)}),i.multiply(n,e.Algebra.divide(i.expand(a),i.expand(t)))}return r},e.Utils.in_inverse_trig=function(e){return-1!==[C,N,I,M,A,E].indexOf(e)},e.Utils.in_trig=function(e){return-1!==[k,U,q,S,x,T].indexOf(e)},e.Utils.in_htrig=function(e){return-1!==[F,R,D,H,O,Q].indexOf(e)};var G=e.Utils.all_functions=function(e){for(var i=0,r=e.length;i<r;i++)if(e[i].group!==a)return!1;return!0},X=e.Utils.cosAsinBtranform=function(e,r){var n,t;return n=e.args[0],t=r.args[0],i.parse(u("(sin(({0})+({1}))-sin(({0})-({1})))/2",n,t))},Z=e.Utils.cosAsinAtranform=function(e,r){return 1!==Number(r.power)?i.multiply(e,r):(n=e.args[0],i.parse(u("(sin(2*({0})))/2",n)));var n},z=e.Utils.cosAsinBtranform=function(e,r){var n,t;return n=e.args[0],t=r.args[0],i.parse(u("(cos(({0})+({1}))-cos(({0})-({1})))/2",n,t))},J=e.Utils.trigTransform=function(e){for(var r,n,t={},o=new s(1),l=0,p=e.length;l<p;l++)if((r=e[l]).group===a){var u=r.fname;u===k&&t[U]?(n=t[U].args[0].toString()!==r.args[0].toString()?X(r,t[U]):Z(r,t[U]),delete t[U],o=i.multiply(o,n)):u===U&&t[k]?(n=t[k].args[0].toString()!==r.args[0].toString()?X(r,t[k]):Z(r,t[k]),delete t[k],o=i.multiply(o,n)):u===U&&t[U]?(t[U].args[0].toString()!==r.args[0].toString()?(n=z(r,t[U]),delete t[U]):(n=i.multiply(r,t[U]),delete t[U]),o=n):t[u]=r}else o=i.multiply(o,r);for(var c in t)o=i.multiply(o,t[c]);return o};e.Settings.integration_depth=10;var K=e.Calculus={version:"1.4.5",sum:function(r,n,t,a){if(n.group!==e.groups.S)throw new e.exceptions.NerdamerTypeError("Index must be symbol. "+o(n)+" provided");var l;if(n=n.value,e.Utils.isNumericSymbol(t)&&e.Utils.isNumericSymbol(a)){var p=a-t<200?"":"PARSE2NUMBER";t=Number(t),a=Number(a),l=e.Utils.block(p,function(){for(var o=r.text(),l={"~":!0},p=new e.Symbol(0),u=t;u<=a;u++){l[n]=new s(u);var c=i.parse(o,l);p=i.add(p,c)}return p})}else l=i.symfunction("sum",arguments);return l},product:function(r,n,t,a){if(n.group!==e.groups.S)throw new e.exceptions.NerdamerTypeError("Index must be symbol. "+o(n)+" provided");var l;if(n=n.value,e.Utils.isNumericSymbol(t)&&e.Utils.isNumericSymbol(a)){var p=a-t<200?"":"PARSE2NUMBER";l=e.Utils.block(p,function(){t=Number(t),a=Number(a.multiplier);for(var o=r.text(),l={},p=new e.Symbol(1),u=t;u<=a;u++)l[n]=new s(u),p=i.multiply(p,i.parse(o,l));return p})}else l=i.symfunction("product",arguments);return l},diff:function(n,p,u){if(e.Utils.isVector(n)){var c=new e.Vector([]);return n.each(function(e){c.elements.push(K.diff(e,p))}),c}var f=t(p)?p.text():p;if(u=t(u)?u.multiplier:u||1,void 0===f&&(f=e.Utils.variables(n)[0]),n.group===a&&n.fname===_){var F=n.args[0],R=n.power.clone();F.group===g&&F.group===b||(F.power=t(F.power)?i.multiply(F.power,i.multiply(new s(.5)),R):F.power.multiply(new r(.5)).multiply(R),F.multiplier=F.multiplier.multiply(n.multiplier)),n=F}if(n.group!==a||t(n.power))n=Z(n);else{var j=Z(n),G=K.diff(n.args[0].clone(),f);n=i.multiply(j,G)}return u>1&&(u--,n=K.diff(n,p,u)),n;function X(e){return(e.value===f||e.contains(f,!0))&&(e.multiplier=e.multiplier.multiply(e.power),e.power=e.power.subtract(new r(1)),e.power.equals(0)&&(e=s(e.multiplier))),e}function Z(e){var n,u,c=e.group;if(c===g||c===m&&e.value!==f||c===b)e=s(0);else if(c===m)e=X(e);else{if(c===v){var _=e.multiplier.clone();e.toUnitMultiplier();var F=i.multiply(function(e){for(var r=e.collectSymbols(),n=new s(0),t=r.length,a=0;a<t;a++){for(var o=K.diff(r[a].clone(),f),l=0;l<t;l++)a!==l&&(o=i.multiply(o,r[l].clone()));n=i.add(n,o)}return n}(e),X(e));return F.multiplier=F.multiplier.multiply(_),F}if(c===a&&e.power.equals(1))switch(e.fname){case h:u=e.clone(),(e=e.args[0].clone()).power=e.power.negate(),e.multiplier=u.multiplier.divide(e.multiplier);break;case k:e.fname=U,e.multiplier.negate();break;case U:e.fname=k;break;case q:e.fname=S,e.power=new r(2);break;case S:e=z(e,q);break;case x:e=z(e,"-cot");break;case T:e.fname=x,e.multiplier.negate(),e.power=new r(2);break;case C:e=i.parse("(sqrt(1-("+o(e.args[0])+")^2))^(-1)");break;case N:e=i.parse("-(sqrt(1-("+o(e.args[0])+")^2))^(-1)");break;case I:e=i.parse("(1+("+o(e.args[0])+")^2)^(-1)");break;case L:_=e.multiplier.clone(),e.toUnitMultiplier(),(n=e.args[0].clone()).toUnitMultiplier(),(e=i.parse(l(o(e.args[0]))+"/abs"+l(o(n)))).multiplier=_;break;case"parens":e=s(1);break;case"cosh":e.fname="sinh";break;case"sinh":e.fname="cosh";break;case D:e.fname=B,e.power=new r(2);break;case B:e=z(e,"-tanh");break;case V:var R=String(e.args[0]);return i.parse("-coth("+R+")*csch("+R+")");case P:R=String(e.args[0]);return i.parse("-csch("+R+")^2");case"asinh":e=i.parse("(sqrt(1+("+o(e.args[0])+")^2))^(-1)");break;case"acosh":e=i.parse("(sqrt(-1+("+o(e.args[0])+")^2))^(-1)");break;case"atanh":e=i.parse("(1-("+o(e.args[0])+")^2)^(-1)");break;case O:R=String(e.args[0]);e=i.parse("-1/(sqrt(1/("+R+")^2-1)*("+R+")^2)");break;case Q:e=i.parse("-1/(("+e.args[0]+")^2-1)");break;case H:R=String(e.args[0]);e=i.parse("-1/(sqrt(1/("+R+")^2+1)*("+R+")^2)");break;case A:R=String(e.args[0]);e=i.parse("1/(sqrt(1-1/("+R+")^2)*("+R+")^2)");break;case M:R=String(e.args[0]);e=i.parse("-1/(sqrt(1-1/("+R+")^2)*("+R+")^2)");break;case E:e=i.parse("-1/(("+e.args[0]+")^2+1)");break;case"S":R=String(e.args[0]);e=i.parse("sin((pi*("+R+")^2)/2)");break;case"C":R=String(e.args[0]);e=i.parse("cos((pi*("+R+")^2)/2)");break;case"Si":R=e.args[0];e=i.parse("sin("+R+")/("+R+")");break;case"Shi":R=e.args[0];e=i.parse("sinh("+R+")/("+R+")");break;case"Ci":R=e.args[0];e=i.parse("cos("+R+")/("+R+")");break;case"Chi":R=e.args[0];e=i.parse("cosh("+R+")/("+R+")");break;case"Ei":R=e.args[0];e=i.parse("e^("+R+")/("+R+")");break;case"Li":R=e.args[0];e=i.parse("1/log("+R+")");break;case"erf":e=i.parse("(2*e^(-("+e.args[0]+")^2))/sqrt(pi)");break;case"atan2":var j=String(e.args[0]),G=String(e.args[1]);e=i.parse("("+G+")/(("+G+")^2+("+j+")^2)");break;case"sign":e=new s(0);break;case"log10":e=i.parse("1/(("+e.args[0]+")*log(10))");break;default:e=i.symfunction("diff",[e,p])}else if(c===y||c===a&&t(e.power)){var J;J=c===y?e.value:c===a&&e.contains(f)?e.fname+l(o(e.args[0])):e.value+l(o(e.args[0])),i.multiply(i.parse(h+l(J)),e.power.clone()),n=K.diff(i.multiply(i.parse(h+l(J)),e.power.clone()),f),e=i.multiply(e,n)}else if(c!==a||e.power.equals(1)){if(c===d||c===w){var W=new s(0);for(var Y in e.symbols)W=i.add(W,K.diff(e.symbols[Y].clone(),f));e=i.multiply(X(e.clone()),W)}}else(n=e.clone()).toLinear(),n.toUnitMultiplier(),e=i.multiply(X(e.clone()),Z(n))}return e.updateHash(),e}function z(e,r,n){return i.multiply(e,i.parse(r+l(n||o(e.args[0]))))}},integration:{u_substitution:function(r,n){function t(e,r,t){var a=t?t(e,r):i.divide(e.clone(),K.diff(r,n));return a.contains(n,!0)?null:a}function o(e,r){var n=K.integrate(i.symfunction(e,[new s(g)]),g,0);return(n=n.sub(new s(g),r)).updateHash(),n}var l,p=r[0].clone(),u=r[1].clone(),c=p.group,f=u.group,g="__u__";if(c===a&&f!==a){if(l=t(u,(m=p.args[0]).clone()))return i.multiply(l,o(p.fname,m));if(l=t(u,p))return K.integration.poly_integrate(p)}else if(f===a&&c!==a){var m;if(l=t(p,(m=u.args[0]).clone()))return i.multiply(l,o(u.fname,m))}else if(c===a&&f===a){if(l=t(p.clone(),u.clone()))return i.multiply(K.integration.poly_integrate(u),l);if(l=t(u.clone(),p.clone()))return i.multiply(K.integration.poly_integrate(u),l)}else{if(c===y&&f!==y){if(!(l=t(u,(_=p.power).clone()))){var w=K.integration.decompose_arg(_.clone(),n),d=K.diff(w[2].clone(),n),v=K.integration.decompose_arg(d.clone(),n);if(i.multiply(w[1],v[1]).power.equals(u.power)){var b=i.divide(w[0].clone(),v[0].clone()),h=i.multiply(b.clone(),i.pow(new s(p.value),i.multiply(w[0],new s(g))));return h=i.multiply(h,new s(g)),K.integration.by_parts(h,g,0,{}).sub(g,w[1].clone())}}var L=K.integrate(p.sub(_.clone(),new s(g)),g,0);return i.multiply(L.sub(new s(g),_),l)}if(f===y&&c!==y){var _;l=t(p,(_=u.power).clone());L=K.integrate(u.sub(_,new s(g)),g,0);return i.multiply(L.sub(new s(g),_),l)}if(p.isComposite()||u.isComposite()){var U=function(r,t){var a=e.Algebra.Factor.factor(r),s=e.Algebra.Factor.factor(K.diff(t,n));return i.divide(a,s)},k=p.isComposite()?p.clone().toLinear():p.clone(),q=u.isComposite()?u.clone().toLinear():u.clone();if(l=t(k.clone(),q.clone(),U))return i.multiply(K.integration.poly_integrate(u),l);if(l=t(q.clone(),k.clone(),U))return i.multiply(K.integration.poly_integrate(p),l)}}},poly_integrate:function(e){var r=e.power.toString(),n=e.multiplier.toDecimal(),t=e.toUnitMultiplier().toLinear();return-1===Number(r)?i.multiply(new s(n),i.symfunction(h,[t])):i.parse(u("({0})*({1})^(({2})+1)/(({2})+1)",n,t,r))},stop:function(i){throw i=i||"Unable to compute integral!",e.Utils.warn(i),new j(i)},partial_fraction:function(r,n,a,o){var l,p;return t(n)||(n=i.parse(n)),l=new s(0),(p=e.Algebra.PartFrac.partfrac(r,n)).group===v&&p.isLinear()?p.each(function(e){l=i.add(l,K.integrate(e,n,a,o))}):l=i.add(l,K.integrate(p,n,a,o)),l},get_udv:function(r){var n=[[],[],[],[],[]],t=function(i){var r=i.group;if(r===a){var t=i.fname;e.Utils.in_trig(t)||e.Utils.in_htrig(t)?n[3].push(i):e.Utils.in_inverse_trig(t)?n[1].push(i):t===h?n[0].push(i):K.integration.stop()}else r===m||i.isComposite()&&i.isLinear()||r===v&&i.isLinear()?n[2].push(i):r===y||i.isComposite()&&!i.isLinear()?n[4].push(i):K.integration.stop()};r.group===v?r.each(function(e){t(s.unwrapSQRT(e,!0))}):t(r);for(var o,l=new s(1),p=0;p<5;p++){var u,c=n[p],f=c.length;if(f>0){if(f>1){u=new s(1);for(var g=0;g<f;g++)u=i.multiply(u,c[g].clone())}else u=c[0].clone();o?l=i.multiply(l,u):(o=u).multiplier=o.multiplier.multiply(r.multiplier)}}return[o,l]},trig_sub:function(r,n,t,a,s,o){(s=s||K.integration.decompose_arg(r.clone().toLinear(),n))[3],s[2];var p=s[0],u=s[1];if(u.power.equals(2)&&p.greaterThan(0)){var c=e.Utils.getU(r),f=i.parse(q+l(c)),g=i.parse(S+l(c)+"^2"),m=i.multiply(r.sub(u,f),g),w=K.integrate(m,c,t,a).sub(f,u);return e.Utils.clearU(f),w}},by_parts:function(r,n,t,a){var o,l,p,u,c,f,g,m,w,d,v,y;if(a.previous=a.previous||[],l=(o=K.integration.get_udv(r))[0],p=o[1],v=(u=s.unwrapSQRT(i.expand(K.diff(l.clone(),n)),!0)).clone().stripVar(n),u=i.divide(u,v.clone()),c=K.integrate(p.clone(),n,t||0),y=(f=i.multiply(c.clone(),u)).toString(),-1!==a.previous.indexOf(y)&&e.Utils.in_trig(l.fname)&&p.isE())return a.is_cyclic=!0,new s(1);if(a.previous.push(y),g=i.multiply(l,c),d=f.multiplier.clone(),f.toUnitMultiplier(),(w=i.multiply(K.integrate(f.clone(),n,t,a),v)).multiplier=w.multiplier.multiply(d),m=i.subtract(g,w),a.is_cyclic&&(a.previous.pop(),0===a.previous.length)){m=i.expand(m);var b=new s(0);m.each(function(e){e.contains(n)||(b=i.add(b,e.clone()))}),m=i.divide(i.subtract(m,b.clone()),i.subtract(new s(1),b))}return m},decompose_arg:e.Utils.decompose_fn},integrate:function(n,o,f,g){if(!o){var b=e.Utils.variables(n);1===b.length&&(o=b[0]),o=o||"x"}if(e.Utils.isVector(n)){var X=new e.Vector([]);return n.each(function(e){X.elements.push(K.integrate(e,o))}),X}return isNaN(o)||i.error("variable expected but received "+o),n.isConstant(!0)?i.multiply(n.clone(),i.parse(o)):(g=g||{},e.Utils.block("PARSE2NUMBER",function(){f=f||0;var b,X=t(o)?o.toString():o,Z=s.unwrapSQRT(n.clone(),!0),z=Z.group;try{if(++f>e.Settings.integration_depth&&K.integration.stop("Maximum depth reached. Exiting!"),Z.contains(X,!0)){if(z===m)b=K.integration.poly_integrate(Z,X,f);else if(z===y)if(Z.contains(X)&&Z.previousGroup!==a){if(Z.power.contains(X))K.integration.stop();else(Ge=K.diff(Z.clone().toLinear(),X)).contains(X)&&K.integration.stop(),b=K.integration.poly_integrate(Z,X,f)}else{if((te=K.diff(Z.power.clone(),X)).contains(X)){var W=te.stripVar(X);if((ae=i.divide(te.clone(),W.clone())).group===m&&ae.isLinear())return W.multiplier=W.multiplier.divide(new r(2)),i.parse(u("({2})*(sqrt(pi)*erf(sqrt(-{0})*{1}))/(2*sqrt(-{0}))",W,X,Z.multiplier));K.integration.stop()}if(Z.isE())te.isLinear()?b=Z:te.isE()&&te.power.group===m&&te.power.power.equals(1)?b=i.multiply(i.symfunction("Ei",[Z.power.clone()]),Z.power):K.integration.stop();else{var Y=i.symfunction(h,[i.parse(Z.value)]);b=i.divide(Z,Y)}b=i.divide(b,te)}else if(Z.isComposite()&&Z.isLinear()){var $=i.parse(Z.multiplier);Z.toUnitMultiplier(),b=new s(0),Z.each(function(e){b=i.add(b,K.integrate(e,X,f))}),b=i.multiply($,b)}else if(z===d)if(Z.power.greaterThan(1)&&(Z=i.expand(Z)),Z.power.equals(1))b=new s(0),Z.each(function(e){b=i.add(b,K.integrate(e,X,f))},!0);else{var ee=Number(Z.power);$=Z.multiplier.clone();Z.toUnitMultiplier();var ie=Z.clone().toLinear(),re=(Ni=K.integration.decompose_arg(ie,X))[3],ne=Ni[2],te=Ni[0],ae=Ni[1];if(-1===ee&&ae.group!==w&&ae.power.equals(2)){var se=!p(re)||re>0;if(ae.group===m&&ae.power.equals(2)&&se){var oe=function(e){var r=new s(1);return e.each(function(e){r=i.multiply(r,"abs"===e.fname?e.args[0]:e)}),r},le=te.clone(),pe=re.clone();le=i.pow(le,new s(.5)),pe=i.pow(pe,new s(.5));Y=i.multiply(oe(pe),oe(le));var ue=i.symfunction(I,[i.divide(i.multiply(te,ae.toLinear()),Y.clone())]);b=i.divide(ue,Y)}else if(ae.group===m&&ae.isLinear())b=i.divide(K.integration.poly_integrate(Z),te);else if(ae.power.equals(4)){var ce,fe,ge,me,we,de,ve=l;le=i.parse(_+ve(te)+"*"+X+"^2"),pe=i.parse(_+ve(2)+"*"+ve(te)+"^"+ve("1/4")+"*"+ve(re)+"^"+ve("1/4")+"*"+X),ce=i.parse(_+ve(re)),Ne=i.add(i.add(le.clone(),pe.clone()),ce.clone()),Ke=i.add(i.subtract(le,pe),ce),fe=i.parse(_+ve(2)+"*"+ve(re)+"^"+ve("3/4")),ge=i.parse(_+ve(re)+"*"+ve(re)+"^"+ve("1/4")+"*"+X),me=i.parse("2*"+ve(re)+"*"+_+ve(2)+"*"+ve(re)+"^"+ve("1/4")),we=i.divide(i.subtract(fe.clone(),ge.clone()),i.multiply(me.clone(),Ke)),de=i.divide(i.add(fe,ge),i.multiply(me,Ne.clone())),b=i.add(K.integrate(we,X,f,g),K.integrate(de,X,f,g))}else b=K.integration.partial_fraction(Z,X,f)}else if(-.5===ee)if(ae.group===m&&ae.power.equals(2))if(ne.multiplier.lessThan(0)&&!re.multiplier.lessThan(0))if(te.negate(),re.isConstant()&&te.isConstant()){Y=i.symfunction(_,[te.clone()]);var ye=i.symfunction(_,[i.multiply(te.clone(),re)]);b=i.divide(i.symfunction(C,[i.divide(ne.toLinear(),ye)]),Y)}else{var be=i.symfunction(_,[te]),he=i.multiply(be.clone(),ae.clone().toLinear());b=i.divide(i.symfunction(I,[i.divide(he,i.symfunction(_,[ie.clone()]))]),be)}else K.integration.stop();else K.integration.stop();else if(ae.isLinear()&&ae.group!==w)b=i.divide(K.integration.poly_integrate(Z),te);else{if(ae.power.equals(2)&&te.greaterThan(0)){var Le,_e,Ue,ke,qe,Se;Le=i.parse(_+l(te)),_e=i.parse(_+l(re)),Ue=i.multiply(Le.clone(),_e.clone()).invert(),ke=i.pow(re,new s(Z.power)),Se=e.Utils.getU(Z),Ii=i.multiply(Ue,ae.clone().toLinear()),qe=i.parse(I+l(Ii));var xe=2*(Math.abs(Z.power)-1),Te=K.integrate(i.parse(k+l(Se)+"^"+xe));return e.Utils.clearU(Se),i.multiply(Te.sub(Se,qe),ke)}if(Z.group===v||Z.power.lessThan(0)){ue=Z.clone().toLinear();var Ce=e.Algebra.Factor.factor(ue).toString()!==ue.toString();if(e.Algebra.degree(ue,i.parse(X)).equals(2)&&!Ce)try{var Ne,Ie,Ae;Ae=e.Algebra.sqComplete(ue,X),Ii=e.Utils.getU(ue),Ne=Ae.f.sub(Ae.a,Ii),Ie=i.pow(Ne,i.parse(Z.power)),b=K.integrate(Ie,Ii).sub(Ii,Ae.a)}catch(e){K.integration.stop()}else b=K.integration.partial_fraction(Z,X,f,g)}else b=K.integration.by_parts(Z,X,f,g)}b.multiplier=b.multiplier.multiply($)}else if(z===a){var Me=Z.args[0];$=Z.multiplier.clone();Z.toUnitMultiplier();te=(Ni=K.integration.decompose_arg(Me,X))[0],ae=Ni[1];var Ee=Z.fname;if(Ee===h||Ee===C||Ee===N||Ee===I&&ae.isLinear()){ee=Z.power.toString();p(ee)&&(f-=ee),b=K.integration.by_parts(Z,X,f,g)}else{if(Ee===q&&Z.power.lessThan(0))return(Hi=Z.clone()).power.negate(),Hi.fname=T,K.integrate(Hi,X,f);if(!te.contains(X,!0)&&Z.isLinear())if(Ee===L){if((ae=i.divide(Me.clone(),te.clone())).group!==m||ae.power.lessThan(0))K.integration.stop();else if(e.Utils.even(ae.power))b=K.integrate(Me,X,f);else{var Fe=K.integrate(ae,X,f);Fe.power=Fe.power.subtract(new r(1)),b=i.multiply(i.multiply(i.symfunction(L,[ae.toLinear()]),Fe),te)}}else{var Re=Z.args[0].group,De=K.integration.decompose_arg(Me,X);switch((Re!==d&&Re!==m&&Re!==v||!De[1].power.equals(1)||Me.hasFunc())&&K.integration.stop(),Ee){case k:b=i.symfunction(U,[Me]);break;case U:(b=i.symfunction(k,[Me])).negate();break;case q:b=i.parse(u("log(sec({0}))",Me));break;case S:b=i.parse(u("log(tan({0})+sec({0}))",Me));break;case x:b=i.parse(u("-log(csc({0})+cot({0}))",Me));break;case T:b=i.parse(u("log(sin({0}))",Me));break;case F:b=i.symfunction(R,[Me]);break;case R:b=i.symfunction(F,[Me]);break;case D:b=i.parse(u("log(cosh({0}))",Me));break;case A:case M:case E:case O:case H:case Q:b=K.integration.by_parts(Z,X,f,g);break;case B:b=i.parse(u("atan(sinh({0}))",Me));break;case V:b=i.parse(u("log(tanh(({0})/2))",Me));break;case P:b=i.parse(u("log(sinh({0}))",Me));break;case"exp":b=K.integrate(i.parse(u("e^({0})",Me)),X,f);break;case"S":Me=Z.args[0].clone();var Ve=(Di=K.integration.decompose_arg(Me,X))[1],Be=Di[0],Pe=Di[3];b=i.parse(u("(cos((1/2)*pi*(({1})+({0})*({2}))^2)+pi*(({1})+({0})*({2}))*S(({1})+({0})*({2})))/(({0})*pi)",Be,Pe,ae));break;case"C":Me=Z.args[0].clone(),Ve=(Di=K.integration.decompose_arg(Me,X))[1],Be=Di[0],Pe=Di[3];b=i.parse(u("(pi*(({1})+({0})*({2}))*C(({1})+({0})*({2}))-sin((1/2)*pi*(({1})+({0})*({2}))^2))/(({0})*pi)",Be,Pe,Ve));break;case"erf":Me=Z.args[0].clone(),Ve=(Di=K.integration.decompose_arg(Me,X))[1],Be=Di[0];b=i.parse(u("e^(-(({2}))^2)/(({0})*sqrt(pi))+(1/({0})+({1}))*erf(({2}))",Be,Ve,Me));break;case"sign":b=i.multiply(Z.clone(),Me.clone());break;default:K.integration.stop()}b=i.divide(b,te)}else if(ae.isLinear()){if(Ee===k||Ee===U)if((ee=Number(Z.power))<0)Z.fname=Ee===U?x:S,Z.invert().updateHash(),b=K.integrate(Z,X,f);else{Me=Z.args[0];var Oe=Z.clone(),He=Z.clone(),Qe=new s((ee-1)/ee),je=i.multiply(te.clone(),new s(ee)).invert();Oe.power=Oe.power.subtract(new r(1)),He.power=He.power.subtract(new r(2));var Ge=i.symfunction(Ee===k?U:k,[Me.clone()]);Ee===U&&Ge.negate(),b=i.add(i.multiply(i.multiply(je,Oe),Ge),i.multiply(Qe,K.integrate(i.parse(He),X,f)))}else if(Ee===q||Ee===T){if(Z.args[0].isLinear(X)){xe=Z.power.subtract(new r(1)).toString();var Xe=Z.clone().toUnitMultiplier(),Ze=i.parse(u((Ee===T?"-":"")+"1/({2}*{0})*{3}({1})^({0})",xe,Me,te,Ee));Xe.power=Xe.power.subtract(new r(2)),Xe.power.equals(0)&&(Xe=i.parse(Xe)),b=i.subtract(Ze,K.integrate(Xe,X,f))}}else if(Ee===S||Ee===x){var ze=Z.power.subtract(new r(1)).toString(),Je=Z.power.subtract(new r(2)).toString(),Ke=Ee===S?q:T,We=(Xe=Z.clone().toUnitMultiplier(),u((Ee===x?"-":"")+"1/({0}*{1})*{4}({3})^({2})*{5}({3})",te,ze,Je,Me,Ee,Ke));Ze=i.parse(We);Xe.power=Xe.power.subtract(new r(2)),Xe.power.equals(0)&&(Xe=i.parse(Xe)),b=i.add(Ze,i.multiply(new s(Je/ze),K.integrate(Xe,X,f)))}else Ee!==R&&Ee!==F||!Z.power.equals(2)?K.integration.stop():b=K.integrate(Z.fnTransform(),X,f)}else K.integration.stop();b.multiplier=b.multiplier.multiply($)}}else if(z===w)b=K.integration.partial_fraction(Z,X,f);else if(z===v){var Ye=Z.stripVar(X),$e=i.divide(Z.clone(),Ye.clone());if(Ye.contains(X)&&($e=i.multiply($e,Ye),Ye=new s(1)),$e.group!==v){if($e.equals(1))return K.integrate(i.expand(Z),X,f);$e.clone().toLinear().isPoly(!0)&&e.Utils.variables($e).length>1&&($e=e.Algebra.Factor.factor($e)),b=K.integrate($e,X,f)}else{var ei=$e.collectSymbols().sort(function(e,i){return e.group===i.group?Number(e.power)===Number(i.power)?e<i?1:-1:i.power-e.power:i.group-e.group}).map(function(e){var r=s.unwrapSQRT(e,!0);return"exp"===r.fname?i.parse(u("({1})*e^({0})",r.args[0],r.multiplier)):r}),ii=ei.length;if(Z.power<0){if(2===ii)return K.integrate(i.expand(Z),X,f,g)}else if(2===ii){try{b=K.integration.u_substitution(ei,X)}catch(e){}if(!b){var ri=ei[0].group,ni=ei[1].group,ti=ei[0],ai=ei[1],si=ti.fname,oi=ai.fname;if(Z=i.multiply(ti.clone(),ai.clone()),ri===a&&ni===a)if(si===h||oi===h)b=K.integration.by_parts(Z.clone(),X,f,g);else{ei.sort(function(e,i){return i.fname>e.fname});var li=ti.args[0];(!li.isLinear()||li.group!==d&&li.group!==v&&li.group!==m)&&K.integration.stop(),ae=(Ni=K.integration.decompose_arg(li,X))[1],te=Ni[0],ae.isLinear()||K.integration.stop();var pi=ai.args[0];if(li.equals(pi))if(si===U&&oi===k||si===k&&oi===U)if(ti.power.lessThan(0)&&K.integration.stop(),si===U&&ti.power.add(ai.power).equals(0))ti.fname=q,ti.updateHash(),b=K.integrate(ti,X,f);else if(c(ti.power)&&oi===k&&ai.power.lessThan(0)){xe=Number(ti.power)/2;var ui=i.parse(u("(1-cos({0})^2)^({1})",ti.args[0],xe));b=K.integrate(i.expand(i.multiply(ui,ai.clone())),X,f,g)}else if(c(ti.power)&&oi===U&&ai.power.lessThan(0)){xe=Number(ti.power)/2,ui=i.parse(u("(1-sin({0})^2)^({1})",ti.args[0],xe));b=K.integrate(i.expand(i.multiply(ui,ai.clone())),X,f,g)}else{var ci=e.Utils.even(ti.power),fi=e.Utils.even(ai.power);if(b=new s(0),ci&&fi){var gi=function(e){var r,n=e.power/2;return r=e.fname===k?"((1/2)+(cos(2*("+e.args[0]+"))/2))^"+n:"((1/2)-(cos(2*("+e.args[0]+"))/2))^"+n,i.parse(r)};te=gi(ti),re=gi(ai),Ge=i.multiply(te,re);return(Hi=i.expand(Ge)).each(function(e){b=i.add(b,K.integrate(e,X,f))}),i.multiply(b,Ye)}ci?(Ii=ti,Xe=ai):(Ii=ai,Xe=ti);var mi=Ii.fname===k?-1:1,wi=((xe=Xe.power)-1)/2,di=i.parse("(1-"+Ii.fname+e.Utils.inBrackets(li)+"^2)^"+wi);(Hi=i.expand(i.multiply(new s(mi),i.multiply(Ii.clone(),di)))).each(function(e){b=i.add(b,K.integration.poly_integrate(e.clone()))})}else if(si===S&&oi===q&&ae.isLinear()&&ai.isLinear())b=i.parse(u("sec({0})^({1})/({1})",ti.args[0],ti.power));else if(si===q&&oi===S&&ae.isLinear())if(ti.isLinear()&&ai.isLinear())b=i.divide(i.symfunction(S,[li.clone()]),te);else if(c(ti.power)){ee=Number(ti.power)/2,Ge=i.parse(u("(sec({0})^2-1)^({1})",ti.args[0],ee));b=K.integrate(i.expand(i.multiply(Ge,ai)),X,f)}else K.integration.stop();else if(si===S&&oi===k)ti.fname=k,ti.invert().updateHash(),b=K.integrate(i.multiply(ti,ai),X,f);else if(si===U&&oi===x)ai.fname=U,ai.invert().updateHash(),b=K.integrate(i.multiply(ti,ai),X,f);else if(si!==q||oi!==k&&oi!==U||!ai.power.lessThan(0)){Ge=i.multiply(ti.fnTransform(),ai.fnTransform());b=K.integrate(i.expand(Ge),X,f)}else{var Ge=i.multiply(ti.fnTransform(),ai);b=K.integrate(i.expand(Ge),X,f)}else if(si!==U&&si!==k||oi!==U&&oi!==k)K.integration.stop();else{var vi=J(ei);b=K.integrate(i.expand(vi),X,f)}}else if(ri===a&&ni===m){var yi=ti.isLinear();if(ti.fname===k&&yi&&ai.power.equals(-1))b=i.symfunction("Ci",[ti.args[0]]);else if(ti.fname===k&&ai.power.equals(-1))b=K.integrate(i.multiply(ti.fnTransform(),ai.clone()),X,f);else if(ti.fname===R&&yi&&ai.power.equals(-1))b=i.symfunction("Chi",[ti.args[0]]);else if(ti.fname===R&&ai.power.equals(-1))b=K.integrate(i.multiply(ti.fnTransform(),ai.clone()),X,f);else if(ti.fname===U&&yi&&ai.power.equals(-1))b=i.symfunction("Si",[ti.args[0]]);else if(ti.fname===U&&ai.power.equals(-1))b=K.integrate(i.multiply(ti.fnTransform(),ai.clone()),X,f);else if(ti.fname===F&&yi&&ai.power.equals(-1))b=i.symfunction("Shi",[ti.args[0]]);else if(ti.fname===F&&ai.power.equals(-1))b=K.integrate(i.multiply(ti.fnTransform(),ai.clone()),X,f);else if(ti.fname===h&&ai.power.equals(-1))b=K.integration.poly_integrate(ti,X,f);else if("erf"===ti.fname){if(ai.power.equals(1)){Be=(Di=K.integration.decompose_arg(ti.args[0],X))[0],Ve=Di[1],Me=ti.args[0].toString();b=i.parse(u("(e^(-(({2}))^2)*(sqrt(pi)*e^((({2}))^2)*(2*({0})^2*({1})^2-3)*erf(({2}))+2*({0})*({1})-2))/(4*sqrt(pi)*({0})^2)",Be,Ve,Me))}}else b=K.integration.by_parts(Z,X,f,g)}else if(ri===y&&ni===m){ae=si===h?K.integration.decompose_arg(ti.args[0],X)[1]:null;b=ti.isE()&&(ti.power.group===m||ti.power.group===v)&&ai.power.equals(-1)?i.symfunction("Ei",[ti.power.clone()]):si===h&&ae.value===ai.value?K.integration.poly_integrate(ti,X,f):K.integration.by_parts(Z,X,f,g)}else if(ri===w&&ni===m){if(ai.value===ti.value&&ti.power.equals(-1)){var bi=Math.min.apply(null,e.Utils.keys(ti.symbols)),hi=Math.min(bi,ai.power),Li=ai.clone();Li.power=new r(hi),ai=i.divide(ai,Li.clone());Ge=new s(0);ti.each(function(e){Ge=i.add(Ge,i.divide(e.clone(),Li.clone()))}),Ge.multiplier=ti.multiplier,Z=i.divide(ai,Ge)}b=K.integration.partial_fraction(Z,X,f)}else if(ri===d&&ni===m){ue=ti.clone().toLinear();var _i=e.Algebra.degree(ue,i.parse(X)).equals(1);if(ti.power.equals(-.5)){te=(Ni=K.integration.decompose_arg(ti.clone().toLinear(),X))[0].negate(),ae=Ni[1],re=Ni[3];var Ui=Number(ti.power),ki=Number(ai.power);if(p(ki)&&e.Utils.even(ki)&&ae.power.equals(2)){var qi=i.divide(i.multiply(i.pow(re.clone(),new s(2)),i.symfunction(_,[i.divide(re.clone(),te.clone())])),i.pow(te.clone(),new s(2)));qi=i.multiply(qi,i.symfunction(_,[re]).invert());var Si=i.parse("sin(u)");Si.power=Si.power.multiply(ai.power);Te=K.integrate(Si,"u",f);var xi=i.parse(C+"("+_+"("+te+"/"+re+")*"+X+")");b=i.multiply(qi,Te.sub(new s("u"),xi))}else if(-.5===Ui){var Ti=function(e,r){var n=i.parse(K.integrate(e,X,f,g).sub(X,u(r,X)));if(!n.hasIntegral())return n};-1===ki?b=Ti(i.expand(i.expand(i.pow(i.multiply(ti.invert(),ai.invert()),new s(2)))).invert(),"sqrt(1-1/({0})^2)"):-2===ki&&(b=Ti(i.sqrt(i.expand(i.divide(i.pow(Z,new s(2)).invert(),i.pow(new s(X),new s(2))).negate())).invert(),"sqrt(1-1/({0})^2)"))}}else if(ti.power.equals(-1)&&ai.isLinear()&&_i)b=K.integration.partial_fraction(Z,X,f);else if(!ti.power.lessThan(0)&&p(ti.power)){var Ci=i.expand(ti);b=new s(0),Ci.each(function(e){e.group===w?e.each(function(e){b=i.add(b,K.integrate(i.multiply(ai.clone(),e),X,f))}):b=i.add(b,K.integrate(i.multiply(ai.clone(),e),X,f))})}else if(ti.power.lessThan(-2))b=K.integration.by_parts(Z,X,f,g);else if(ti.power.lessThan(0)&&ai.power.greaterThan(1)){var Ni;te=(Ni=K.integration.decompose_arg(ti.clone().toLinear(),X))[0].negate(),ae=Ni[1],re=Ni[3],ie=ti.clone().toLinear();if(ae.group!==w&&ae.isLinear()){ee=Number(ai.power);var Ii=new s(Vi="_u_"),Ai=i.expand(i.divide(i.pow(i.subtract(Ii.clone(),re.clone()),new s(ee)),Ii.clone())),Mi={};Mi[Vi]=ie;var Ei=i.parse(Ai,Mi);b=K.integrate(Ei,X,0)}else if(ai.power.greaterThan(ae.power)||ai.power.equals(ae.power)){var Fi=new e.Algebra.Classes.Factors;ti=e.Algebra.Factor.coeffFactor(ti.invert(),Fi);var Ri=e.Algebra.divide(ai,ti);Ri.group!==v?(b=new s(0),Ri.each(function(e){b=i.add(b,K.integrate(e,X,f))}),Fi.each(function(e){b=i.divide(b,e)}),b=i.expand(b)):b=K.integration.by_parts(Z,X,f,g)}else b=K.integration.partial_fraction(Z,X,f)}else if(ti.power.den.equals(2)){var Di;te=(Di=K.integration.decompose_arg(ti.clone().toLinear(),X))[3],ae=Di[1],re=Di[0],Di[2];if(ae.power.equals(2)&&re.lessThan(0)){te.equals(1)||(Ye=i.multiply(Ye,i.pow(te,new s(2))));Ii=X,qi=i.divide(i.pow(re.clone().negate(),new s(.5)),i.pow(te,new s(.5)));var Vi=i.symfunction(k,[new s(Ii)]),Bi=i.pow(i.symfunction(k,[new s(Ii)]),new s(ti.power.num)),Pi=i.pow(i.symfunction(U,[new s(Ii)]),new s(ai.power)),Oi=i.multiply(i.multiply(Bi,Vi),Pi);Te=K.integrate(Oi,Ii,f);b=Te.sub(Ii,i.symfunction(C,[i.multiply(new s(X),qi)]))}else b=K.integration.partial_fraction(Z,X,f,g)}else _i&&(b=K.integration.partial_fraction(Z,X,f))}else if(ti.isComposite()&&ai.isComposite())if(b=new s(0),ti.power.greaterThan(0)&&ai.power.greaterThan(0)){var Hi;(Hi=i.expand(Z)).each(function(e){b=i.add(b,K.integrate(e,X,f))},!0)}else{Ui=Number(ti.power),ki=Number(ai.power);if(Ui<0&&ki>0){Ge=ti;ti=ai,ai=Ge}-1===Ui&&-1===ki?b=K.integration.partial_fraction(Z,X):ti.each(function(e){var r=i.multiply(e,ai.clone()),n=K.integrate(r,X,f);b=i.add(b,n)})}else if(ri===d&&ei[0].power.greaterThan(0))ti=i.expand(ti),b=new s(0),ti.each(function(e){b=i.add(b,K.integrate(i.multiply(e,ai.clone()),X,f))},!0);else if(ri===a&&ni===y&&e.Utils.in_htrig(ti.fname))ti=ti.fnTransform(),b=K.integrate(i.expand(i.multiply(ti,ai)),X,f);else if(ri===a&&ni===d||ni===a&&ri===d){if(ni===a&&ri===d){Ge=ti;ti=ai,ai=Ge}var Qi,ji,Gi;if(Vi=s.unwrapSQRT(K.diff(ti.clone(),X),!0),Qi=s.unwrapSQRT(ai,!0),Vi.power.equals(Qi.power)){if(ee=new s(ai.power),ji=Vi.clone().toLinear(),Gi=ai.clone().toLinear(),(Qe=e.Algebra.divide(ji.toLinear(),Gi)).isConstant()){var Xi=i.pow(Qe,ee.negate());b=i.multiply(Xi,K.integration.poly_integrate(ti.clone()))}}else b=K.integration.by_parts(Z,X,f,g)}else b=K.integration.by_parts(Z,X,f,g)}}else if(3===ii&&(ei[2].group===m&&ei[2].power.lessThan(2)||ei[0].group===d)){var Zi=ei[0];if(Zi.group===d){Zi.power.greaterThan(1)&&(Zi=i.expand(Zi));Xe=i.multiply(ei[1],ei[2]);b=new s(0),Zi.each(function(e){var r=i.multiply(e,Xe.clone()),n=K.integrate(r,X,f);b=i.add(b,n)},!0)}else b=K.integration.by_parts(Z,X,f,g)}else if(G(ei)){Ge=new s(1);var zi=0;for(ii=ei.length;zi<ii;zi++)Ge=i.multiply(Ge,ei[zi].fnTransform());Ge=i.expand(Ge),b=K.integrate(Ge,X,f)}else{vi=J(ei);b=K.integrate(i.expand(vi),X,f)}}b=i.multiply(b,Ye)}}else b=i.multiply(Z.clone(),i.parse(X));if(b)return b}catch(i){if(!(i instanceof j||i instanceof e.exceptions.DivisionByZero))throw i}return i.symfunction("integrate",[n,o])},!1))},defint:function(r,n,t,a){a=a||"x";var o,l=function(e,r,n){try{return i.parse(e,r)}catch(i){return K.Limit.limit(e,a,n)}},p=e.Utils.variables(r),u=K.integrate(r,a);if(1===p.length&&(a=p[0]),u.hasIntegral())if(1===p.length&&n.isConstant()&&t.isConstant()){var c=e.Utils.build(r);o=new s(e.Math2.num_integrate(c,Number(n),Number(t)))}else o=i.symfunction("defint",[r,n,t,a]);else{var f,g,m={},w={};m[a]=t,w[a]=n,f=l(u,m,t),g=l(u,w,n),o=i.subtract(f,g)}return o},Limit:{interval:function(e,r){return i.parse(u("[{0}, {1}]",e,r))},diverges:function(){return K.Limit.interval("-Infinity","Infinity")},divide:function(r,n,t,a){r.clone(),n.clone();var o=function(i){if(e.Utils.isVector(i)){for(var r=0;r<i.elements.length;r++)if(!i.elements[r].isInfinity)return!1;return!0}return i.isInfinity},l=function(i,r){return!e.Utils.isVector(i)&&i.equals(r)};do{var p=f(K.Limit.limit(r,t,a)),u=f(K.Limit.limit(n,t,a)),c=o(p)&&o(u)||l(p,0)&&l(u,0);if(c){var g=K.diff(r.clone(),t),m=K.diff(n.clone(),t),w=i.expand(i.divide(g,m));r=w.getNum(),n=w.getDenom()}}while(c);return p.isInfinity&&u.equals(0)?p:p.equals(0)&&u.isInfinity?p:p.isInfinity?p:u.isInfinity?new s(0):u.equals(0)?K.Limit.diverges():i.divide(p,u)},rewriteToLog:function(e){var r=e.power.clone();return e.toLinear(),i.pow(new s("e"),i.multiply(r,i.symfunction("log",[e])))},getSubbed:function(e,i,r){var n;e.group===y&&(e=K.rewriteToLog(e));try{n=e.sub(i,r)}catch(i){n=e}return n},isInterval:function(i){return e.Utils.isVector(i)},isConvergent:function(e){return!(K.Limit.isInterval(e)&&e.elements[0].isInfinity&&e.elements[1].isInfinity||e.containsFunction("limit"))},limit:function(r,t,o){var l=i.parse(r.multiplier);r.toUnitMultiplier();try{var p;if(r.isConstant(!0))p=r;else{var c={};c[t]=o;try{var g=i.parse(r.sub(t,o),c);(g.isConstant(!0)||g.isInfinity)&&(p=g)}catch(e){}if(!p){var w=r.getNum(),d=r.getDenom();if(d.isConstant(!0)){if(r.group===y){var b=r.clone().toLinear(),L=(r.power.clone(),b.getNum()),_=b.getDenom(),S=e.Utils.decompose_fn(_,t,!0);if(L.group===m&&L.multiplier.isOne()&&S.ax.group===m&&S.b.isConstant(!0)&&S.a.isOne()&&S.b.isConstant(!0))p=i.parse(u("(1/e^({0}))",S.b));else{var x=K.Limit.rewriteToLog(r.clone()),T=x.power.clone(),C=x.clone().toLinear(),N=K.Limit.limit(C,t,o),I=K.Limit.limit(T,t,o);p=i.pow(N,I)}}else if(r.group===a&&1===r.args.length){var A=K.Limit.limit(r.args[0],t,o);if(A.isConstant(!0)){var M,E=i.symfunction(r.fname,[A]);try{f(E),M=!0}catch(e){M=!1}}if(M)p=E;else if(K.Limit.isConvergent(A))if(r.fname===h)switch(A.toString()){case"0":p=s.infinity().negate();break;case"Infinity":case"-Infinity":p=s.infinity()}else if(r.fname!==k&&r.fname!==U||!o.isInfinity){if(r.fname===q){var F=r.args[0],R=F.getNum(),D=F.getDenom(),V=R.toUnitMultiplier();(o.isInfinity||V.equals("pi")&&D.equals(2))&&(p=divergent())}else if(r.fname===n.FACTORIAL&&A.isInfinity)return s.infinity()}else p=K.Limit.interval(-1,1)}else if(r.group===m){if(r.power>0)return i.parse(r,c);p=e.Utils.even(r.power)?s.infinity():K.Limit.diverges()}else if(r.group===v)if((r=i.expand(r)).group!==v)p=K.Limit.limit(r,t,o);else{var B,P,O=r.collectSymbols().sort(function(e,i){return e.group-i.group});b=O.pop();for(B=f(K.Limit.limit(b,t,o));O.length;){var H=O.pop();P=f(K.Limit.limit(H,t,o)),B.isInfinity||!K.Limit.isConvergent(B)&&P.equals(0)||B.equals(0)&&K.Limit.isConvergent(P)?(H.invert(),B=K.Limit.divide(b,H,t,o)):(B=i.multiply(B,P),b=i.multiply(b,H))}p=B}else if(r.isComposite()){var Q,j=r.clone();r.isLinear()||(r=i.expand(r)),p=new s(0),r.each(function(n){try{Q=K.Limit.limit(n,t,o)}catch(e){Q=K.Limit.diverges()}try{p=i.add(p,Q)}catch(i){r=e.Utils.toCommonDenominator(j),p=K.Limit.limit(r,t,o)}})}}else p=K.Limit.divide(w,d,t,o)}}p||(p=i.symfunction("limit",arguments))}catch(e){p=i.symfunction("limit",arguments)}return i.multiply(l,p)}},Fresnel:{S:function(e){return e.isConstant(!0)?K.defint(i.parse("sin(pi*x^2/2)"),s(0),e,"x"):i.symfunction("S",arguments)},C:function(e){return e.isConstant(!0)?K.defint(i.parse("cos(pi*x^2/2)"),s(0),e,"x"):i.symfunction("C",arguments)}}};nerdamer.register([{name:"diff",visible:!0,numargs:[1,3],build:function(){return K.diff}},{name:"sum",visible:!0,numargs:4,build:function(){return K.sum}},{name:"product",visible:!0,numargs:4,build:function(){return K.product}},{name:"integrate",visible:!0,numargs:[1,2],build:function(){return K.integrate}},{name:"defint",visible:!0,numargs:[3,4],build:function(){return K.defint}},{name:"S",visible:!0,numargs:1,build:function(){return K.Fresnel.S}},{name:"C",visible:!0,numargs:1,build:function(){return K.Fresnel.C}},{name:"limit",visible:!0,numargs:[3,4],build:function(){return K.Limit.limit}}]),nerdamer.api()}();