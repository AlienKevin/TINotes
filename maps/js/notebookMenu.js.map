{"version":3,"sources":["notebookMenu.js"],"names":["toggleBtn","document","querySelector","sidebar","getElementById","addNotebookBtn","addEventListener","event","preventDefault","classList","toggle","defaultNotebookName","notebookNameList","getCurrentNotebook","notebook","Object","keys","localStorage","forEach","key","console","log","getItemFromStorage","renameNotebook","notebookLabel","oldNotebookName","innerHTML","notebookNameInput","createItemNameInput","insertAfter","focus","remove","e","keyCode","newNotebookName","value","indexOf","createErrorMessage","replaceElementInArray","renameNotebookInStorage","displayNotebookLabel","notebookName","labelPosition","createElement","add","textContent","appendChild","getNotebookFromStorage","then","setNotebookInStorage","removeNotebookFromStorage","localforage","removeItem","catch","err","getItem","setItem"],"mappings":"AAAA,MAAMA,UAAYC,SAASC,cAAc,8BACnCC,QAAUF,SAASG,eAAe,WAClCC,eAAiBJ,SAASG,eAAe,kBAC/CJ,UAAUM,iBAAiB,QAAUC,IACjCA,EAAMC,iBACNL,QAAQM,UAAUC,OAAO,UACzBV,UAAUS,UAAUC,OAAO,YAE/B,MAAMC,oBAAsB,YACtBC,kBADsB,aAK5B,SAASC,qBACL,MAAMC,KAKN,OAJAC,OAAOC,KAAKC,cAAcC,QAAQC,IAC9BC,QAAQC,IAAI,WAAYF,GACxBL,EAASK,GAAOG,mBAAmBH,KAEhCL,EAGX,SAASS,eAAeC,GACpB,MAAMC,EAAkBD,EAAcE,UAChCC,EAAoBC,oBAAoB,YAC9CC,YAAYL,EAAeG,GAC3BA,EAAkBG,QAClBN,EAAcO,SACdJ,EAAkBrB,iBAAiB,WAAa0B,IAC5C,GAAiB,IAAbA,EAAEC,QAAe,CACjB,MAAMC,EAAkBP,EAAkBQ,MACtCvB,iBAAiBwB,QAAQF,IAAoB,GAAKA,IAAoBT,EACtEY,mBAAmBV,EACf,6BAEJW,sBAAsB1B,iBAAkBa,EAAiBS,GACzDK,wBAAwBd,EAAiBS,GACzCM,qBAAqBN,EAAiBP,GAEtCA,EAAkBI,aAMlC,SAASS,qBAAqBC,EAAcC,GACxC,MAAMlB,EAAgBvB,SAAS0C,cAAc,MAC7CnB,EAAcf,UAAUmC,IAAI,QAC5BpB,EAAcf,UAAUmC,IAAI,YAC5BpB,EAAcqB,YAAcJ,EACxBC,EACAb,YAAYa,EAAelB,GAE3BrB,QAAQ2C,YAAYtB,GAI5B,SAASe,wBAAwBd,EAAiBS,GAC9Ca,uBAAuBtB,GAClBuB,KAAMlC,GAAamC,qBAAqBf,EAAiBpB,IAC9DoC,0BAA0BzB,GAG9B,SAASyB,0BAA0BT,GAC/BU,YAAYC,WAAWX,GAAcY,MAAM,SAAUC,GACjDlC,QAAQC,IAAIiC,KAIpB,SAASP,uBAAuBN,GAC5B,OAAOU,YAAYI,QAAQd,GAG/B,SAASQ,qBAAqBR,EAAc3B,GACxCqC,YAAYK,QAAQf,EAAc3B,GAAUuC,MAAMC,IAC9ClC,QAAQC,IAAIiC,KAhEpBL,qBAH4B,YAGcpC","file":"../../TextReader/js/notebookMenu.js","sourcesContent":["const toggleBtn = document.querySelector('#hamburger-icon.toggle-btn');\r\nconst sidebar = document.getElementById(\"sidebar\");\r\nconst addNotebookBtn = document.getElementById(\"addNotebookBtn\");\r\ntoggleBtn.addEventListener(\"click\", (event) => {\r\n    event.preventDefault(); // prevent scrolling up to top\r\n    sidebar.classList.toggle(\"active\");\r\n    toggleBtn.classList.toggle(\"active\");\r\n});\r\nconst defaultNotebookName = \"notebook1\";\r\nconst notebookNameList = [defaultNotebookName];\r\n// store the default notebook\r\nsetNotebookInStorage(defaultNotebookName, getCurrentNotebook());\r\n\r\nfunction getCurrentNotebook() {\r\n    const notebook = {};\r\n    Object.keys(localStorage).forEach(key => {\r\n        console.log('TCL: key', key);\r\n        notebook[key] = getItemFromStorage(key);\r\n    })\r\n    return notebook;\r\n}\r\n\r\nfunction renameNotebook(notebookLabel) {\r\n    const oldNotebookName = notebookLabel.innerHTML;\r\n    const notebookNameInput = createItemNameInput(\"notebook\");\r\n    insertAfter(notebookLabel, notebookNameInput);\r\n    notebookNameInput.focus();\r\n    notebookLabel.remove();\r\n    notebookNameInput.addEventListener(\"keypress\", (e) => {\r\n        if (e.keyCode == 13) { // ENTER key\r\n            const newNotebookName = notebookNameInput.value;\r\n            if (notebookNameList.indexOf(newNotebookName) >= 0 && newNotebookName !== oldNotebookName) { // repeated name\r\n                createErrorMessage(notebookNameInput,\r\n                    `Duplicated notebook name`);\r\n            } else {\r\n                replaceElementInArray(notebookNameList, oldNotebookName, newNotebookName);\r\n                renameNotebookInStorage(oldNotebookName, newNotebookName);\r\n                displayNotebookLabel(newNotebookName, notebookNameInput);\r\n                // remove item name input\r\n                notebookNameInput.remove();\r\n            }\r\n        }\r\n    })\r\n}\r\n\r\nfunction displayNotebookLabel(notebookName, labelPosition) {\r\n    const notebookLabel = document.createElement(\"li\");\r\n    notebookLabel.classList.add(\"item\");\r\n    notebookLabel.classList.add(\"notebook\");\r\n    notebookLabel.textContent = notebookName;\r\n    if (labelPosition) {\r\n        insertAfter(labelPosition, notebookLabel);\r\n    } else {\r\n        sidebar.appendChild(notebookLabel);\r\n    }\r\n}\r\n\r\nfunction renameNotebookInStorage(oldNotebookName, newNotebookName) {\r\n    getNotebookFromStorage(oldNotebookName)\r\n        .then((notebook) => setNotebookInStorage(newNotebookName, notebook));\r\n    removeNotebookFromStorage(oldNotebookName);\r\n}\r\n\r\nfunction removeNotebookFromStorage(notebookName) {\r\n    localforage.removeItem(notebookName).catch(function (err) {\r\n        console.log(err);\r\n    });\r\n}\r\n\r\nfunction getNotebookFromStorage(notebookName) {\r\n    return localforage.getItem(notebookName);\r\n}\r\n\r\nfunction setNotebookInStorage(notebookName, notebook) {\r\n    localforage.setItem(notebookName, notebook).catch(err => {\r\n        console.log(err);\r\n    });\r\n}"]}