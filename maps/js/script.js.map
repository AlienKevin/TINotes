{"version":3,"sources":["script.js"],"names":["lineLength","rowLength","menuTitleLength","menuItemLength","calculatorType","minMenuItemLength","newFolderBtn","document","getElementById","newFileBtn","backBtn","clearBtn","system","navigationBar","homePosition","position","itemNameList","types","defaultToUppercase","lastFileContent","conversionTable","alpha","beta","gamma","Delta","delta","epsilon","pi","lambda","mu","Omega","phat","Phi","rho","Sigma","sigma","tau","sqrt(","integral","<=",">=","!=","updateAtPosition","currentPosition","iterateStorage","item","itemName","itemType","push","displayItem","updateItemSize","displayNavigationBar","removeAllChildren","positions","split","i","length","createPositionLabel","slice","join","positionLabel","createElement","classList","add","innerHTML","getEndOfPosition","addEventListener","setPosition","appendChild","insertAdjacentHTML","changeCalculatorType","removeItemPlaceholder","placeholder","remove","displayItemPlaceholder","id","swal","title","buttons","file","text","value","className","folder","then","createMenuItem","func","index","localStorage","key","getItemFromStorage","type","toggleBtnHighlight","e","target","contains","toggle","toLowerCase","indexOf","TypeError","itemNameInput","createItemNameInput","keyCode","shortItemName","fullItemName","getFullItemName","createErrorMessage","storeNewItem","focus","setAttribute","maxLength","spellcheck","style","display","marginTop","marginBottom","message","querySelectorAll","forEach","el","popup","insertAfter","console","log","itemInfo","setItemInStorage","openFileEditField","openEquationEditField","clearAllItems","appendPosition","newPosition","substring","lastIndexOf","getStartOfPosition","itemPosition","itemLabel","displayedName","itemLabelText","link","editField","storeItem","getAttribute","displayFile","displayEquation","storeFile","storeEquation","createFileEditor","editor","rows","cols","fileName","fileInfo","deleteItem","removeItemFromStorage","removeElementInArray","removeLink","linkedItemName","renameItem","oldItemName","newItemName","replaceElementInArray","renameItemInStorage","pinToHome","originalItemName","originalItemType","sameName","newName","cancel","icon","timer","linkItemToHome","askForNewLinkedName","content","element","attributes","shortlinkedItemName","originalItem","undefined","getItemNamesAtPosition","alertTitle","button","Error","linkedItem","clone","restrictContextItems","pinToHomeBtn","querySelector","removeItem","JSON","parse","getItem","setItem","stringify","convertWordsToSymbols","str","Object","entries","replace","RegExp","escape","convertSymbolsToWords","convertSingleQuotesToDoubleQuotes","convertDoubleQuotesToSingleQuotes","decodeFileContent","fileContent","convertSpacesToNewlines","encodeFileContent","convertNewlinesToSpaces","convertToUppercase","result","char","test","toUpperCase","toUppercase","start","end","insertSubstring","controlDiv","submitBtn","Mousetrap","bind","combo","click","uppercaseCheckBox","checked","fileLabel","sizeString","countItemSize","sizeLabel","getElementsByClassName","countFileSize","countFolderSize","folderName","size","inputStr","previousNewlineIndex","newlineIndex","numOfSpaces","spaces","deleteSubstring","dangerMode","willDelete","removeItemList","startsWith"],"mappings":"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","file":"../../TextReader/js/script.js","sourcesContent":["// set up calculator type\r\nlet calculatorType = \"color\";\r\n// maximum lengths allowed because of screen size limitation\r\nlet\r\n    lineLength, rowLength, menuTitleLength, menuItemLength;\r\n// minimum length required, no empty string\r\nconst minMenuItemLength = 1;\r\nconst newFolderBtn = document.getElementById(\"newFolderBtn\");\r\nconst newFileBtn = document.getElementById(\"newFileBtn\");\r\nconst backBtn = document.getElementById(\"backBtn\");\r\nconst clearBtn = document.getElementById(\"clearBtn\");\r\nconst system = document.getElementById(\"system\");\r\nconst navigationBar = document.getElementById(\"navigationBar\");\r\nconst homePosition = \"home\";\r\nlet position = homePosition; // default root location for the file system\r\nconst itemNameList = [];\r\n// valid types of note items\r\nconst types = [\"file\", \"folder\", \"equation\"];\r\nlet defaultToUppercase = true; // default auto convert to uppercase\r\nlet lastFileContent = \"\"; // file editor's previous content\r\nconst conversionTable = {\r\n    // greek letters\r\n    alpha: \"Œ±\",\r\n    beta: \"Œ≤\",\r\n    gamma: \"Œ≥\",\r\n    Delta: \"Œî\",\r\n    delta: \"Œ¥\",\r\n    epsilon: \"Œµ\",\r\n    pi: \"œÄ\",\r\n    lambda: \"Œª\",\r\n    mu: \"Œº\",\r\n    Omega: \"Œ©\",\r\n    phat: \"pÃÇ\",\r\n    Phi: \"Œ¶\",\r\n    rho: \"œÅ\",\r\n    Sigma: \"Œ£\",\r\n    sigma: \"œÉ\",\r\n    tau: \"œÑ\",\r\n\r\n    // other symbols\r\n    \"sqrt(\": \"‚àö(\",\r\n    \"integral\": \"‚à´\",\r\n    \"<=\": \"‚â§\",\r\n    \">=\": \"‚â•\",\r\n    \"!=\": \"‚â†\",\r\n}\r\n\r\n// show item navigation bar\r\ndisplayNavigationBar();\r\n\r\n// manage calculator type selection\r\nchangeCalculatorType();\r\n\r\ndocument.querySelector(`input#${calculatorType}`).setAttribute(\"checked\", true);\r\ndocument.querySelectorAll('input[name=\"calculatorType\"]')\r\n    .forEach((el) => {\r\n        el.addEventListener(\"change\", (e) => {\r\n            calculatorType = e.target.value;\r\n            changeCalculatorType();\r\n            // console.log('TCL: e.target', e.target);\r\n        })\r\n    });\r\n\r\n// load items from last time in localStorage\r\nupdateAtPosition(homePosition);\r\n\r\nfunction updateAtPosition(currentPosition) {\r\n    iterateStorage(function (item, itemName, itemType) {\r\n        // console.log('TCL: updateAtPosition -> item', item);\r\n        if (item.position === currentPosition) { // only show ones at home position\r\n            itemNameList.push(itemName);\r\n            displayItem(itemName, itemType);\r\n            updateItemSize(itemName);\r\n        }\r\n    });\r\n}\r\n\r\n// Display file/folder placeholder (hint) in case home folder is empty\r\ndisplayItemPlaceholder();\r\n\r\n// set up buttons\r\n\r\n// button for creating a new folder\r\nnewFolderBtn.addEventListener(\"click\", () => {\r\n    createMenuItem(\"folder\");\r\n});\r\nMousetrap.bind(\"shift+f\", (e) => { // keyboard shortcut\r\n    newFolderBtn.click();\r\n    return false; // prevent event's default behavior\r\n});\r\n\r\n// button for creating a new file\r\nnewFileBtn.addEventListener(\"click\", () => {\r\n    createMenuItem(\"file\");\r\n});\r\nMousetrap.bind(\"shift+t\", (e) => { // keyboard shortcut\r\n    newFileBtn.click();\r\n    return false;\r\n});\r\n\r\n// moving back to parent folder\r\nbackBtn.addEventListener(\"click\", () => {\r\n    iterateStorage(function (item, itemName, itemType, itemPosition, index) {\r\n        if (itemName === position) {\r\n            setPosition(itemPosition);\r\n        }\r\n    })\r\n})\r\nMousetrap.bind(\"backspace\", () => {\r\n    backBtn.click();\r\n})\r\n\r\nclearBtn.addEventListener(\"click\", () => {\r\n    // Based on: https://sweetalert.js.org/guides/#getting-started\r\n    swal({\r\n            title: \"Are you sure?\",\r\n            text: \"Once deleted, you will not be able to recover this folder!\",\r\n            icon: \"warning\",\r\n            buttons: true,\r\n            dangerMode: true,\r\n        })\r\n        .then((willDelete) => {\r\n            if (willDelete) {\r\n                swal(\"All items are deleted in this folder\", {\r\n                    icon: \"success\",\r\n                    buttons: false,\r\n                    timer: 800,\r\n                });\r\n                // remove all items in current position (folder)\r\n                // itemNameList.forEach(item => {\r\n                //     removeItemFromStorage(item);\r\n                // });\r\n                // console.log('TCL: position', position);\r\n                const removeItemList = [];\r\n                iterateStorage(function (item, itemName, itemType, itemPosition, index) {\r\n                    // console.log('TCL: itemPosition', itemPosition);\r\n                    // console.log('TCL: itemName', itemName);\r\n                    if (itemPosition.startsWith(position)) {\r\n                        removeItemList.push(itemName);\r\n                    }\r\n                });\r\n                removeItemList.forEach((item) => {\r\n                    removeItemFromStorage(item)\r\n                });\r\n                // clear the representation of items in the window\r\n                clearAllItems();\r\n                displayItemPlaceholder(); // show placeholder\r\n            }\r\n        });\r\n});\r\n\r\nfunction displayNavigationBar() {\r\n    removeAllChildren(navigationBar);\r\n    // console.log('TCL: displayNavigationBar -> position', position);\r\n    const positions = position.split(\"/\");\r\n    for (let i = 0; i < positions.length; i++) {\r\n        createPositionLabel(positions.slice(0, i + 1).join(\"/\"));\r\n    }\r\n}\r\n\r\nfunction createPositionLabel(position) {\r\n    // console.log('TCL: createPositionLabel -> position', position);\r\n    const positionLabel = document.createElement(\"span\");\r\n    positionLabel.classList.add(\"btn\");\r\n    positionLabel.classList.add(\"positionLabel\");\r\n    positionLabel.innerHTML = getEndOfPosition(position);\r\n    positionLabel.addEventListener(\"click\", () => {\r\n        setPosition(position);\r\n        // console.log('TCL: createPositionLabel -> position', position);\r\n    });\r\n    navigationBar.appendChild(positionLabel);\r\n    positionLabel.insertAdjacentHTML(\"afterend\", `<i class=\"far fa-angle-right\"></i>`);\r\n}\r\n\r\nfunction changeCalculatorType() {\r\n    // set up variables for different calculators\r\n    switch (calculatorType) {\r\n        case \"monochrome\": // e.g. TI-83\r\n            lineLength = 16;\r\n            rowLength = 8;\r\n            break;\r\n        case \"color\": // e.g. TI-84/CSE/CE\r\n            lineLength = 26;\r\n            rowLength = 10;\r\n            break;\r\n    }\r\n    menuTitleLength = lineLength;\r\n    menuItemLength = lineLength - 2;\r\n}\r\n\r\nfunction removeItemPlaceholder() {\r\n    let placeholder = document.getElementById(\"newItemPlaceholder\");\r\n    if (placeholder) { // remove previous placeholder\r\n        placeholder.remove();\r\n    }\r\n}\r\n\r\nfunction displayItemPlaceholder() {\r\n    removeItemPlaceholder();\r\n    if (itemNameList.length === 0) {\r\n        const placeholder = document.createElement(\"p\");\r\n        placeholder.id = \"newItemPlaceholder\";\r\n        placeholder.classList.add(\"btn\");\r\n        placeholder.innerHTML = \"Create a New File or Folder\";\r\n        placeholder.addEventListener(\"click\", () => {\r\n            swal({\r\n                    title: \"Create a file or folder?\",\r\n                    buttons: {\r\n                        file: {\r\n                            text: \"File\",\r\n                            value: \"file\",\r\n                            className: \"blurred centered\",\r\n                        },\r\n                        folder: {\r\n                            text: \"Folder\",\r\n                            value: \"folder\",\r\n                            className: \"blurred centered\",\r\n                        },\r\n                    },\r\n                })\r\n                .then((value) => {\r\n                    // console.log('TCL: displayNewItemPlaceholder -> value', value);\r\n                    if (value) {\r\n                        createMenuItem(value);\r\n                    }\r\n                });\r\n        });\r\n        system.appendChild(placeholder);\r\n    }\r\n}\r\n\r\n// iterate through storage for access\r\n// DO NOT DELETE ANY ITEMS IN STORAGE, THIS WILL MESS UP THE LOOP INDEX!!!\r\nfunction iterateStorage(func) {\r\n    for (let index = 0; index < localStorage.length; index++) {\r\n        const itemName = localStorage.key(index);\r\n        const item = getItemFromStorage(itemName);\r\n        func(item, itemName, item.type, item.position, index);\r\n    }\r\n}\r\n\r\nfunction toggleBtnHighlight(e) {\r\n    if (e.target.classList.contains(\"btn\")) {\r\n        e.target.classList.toggle(\"btn-hover\");\r\n    }\r\n}\r\n\r\ndocument.addEventListener(\"mouseover\", toggleBtnHighlight)\r\n\r\ndocument.addEventListener(\"mouseout\", toggleBtnHighlight)\r\n\r\nfunction createMenuItem(type) {\r\n    removeItemPlaceholder();\r\n    type = type.toLowerCase();\r\n    if (types.indexOf(type) < 0) {\r\n        throw new TypeError(`menu item's type should be either folder or file, not ${type}`);\r\n    }\r\n    const itemNameInput = createItemNameInput(type);\r\n    itemNameInput.addEventListener('keypress', (e) => {\r\n        if (e.keyCode == 13) { // ENTER key\r\n            const shortItemName = itemNameInput.value;\r\n            const fullItemName = getFullItemName(shortItemName);\r\n            if (shortItemName.length >= minMenuItemLength) {\r\n                if (itemNameList.indexOf(fullItemName) >= 0) { // repeated name\r\n                    createErrorMessage(itemNameInput,\r\n                        `Duplicated ${type} name, ${type} name must be unique`);\r\n                } else {\r\n                    itemNameList.push(fullItemName);\r\n                    displayItem(fullItemName, type, itemNameInput);\r\n                    storeNewItem(itemNameInput, type, position);\r\n                    // remove item name input\r\n                    itemNameInput.remove();\r\n                }\r\n            } else {\r\n                createErrorMessage(itemNameInput, `${type} name can't be empty`);\r\n            }\r\n        }\r\n    });\r\n    system.appendChild(itemNameInput);\r\n    itemNameInput.focus();\r\n}\r\n\r\nfunction getFullItemName(shortItemName) {\r\n    return `${position}/${shortItemName}`;\r\n}\r\n\r\n// Create input box for entering name of the file or folder\r\nfunction createItemNameInput(type) {\r\n    const itemNameInput = document.createElement(\"input\");\r\n    itemNameInput.setAttribute(\"type\", \"text\");\r\n    itemNameInput.placeholder = `Enter ${type} name here`;\r\n    // minLength must be detected in ENTER key press event\r\n    itemNameInput.maxLength = menuItemLength;\r\n    itemNameInput.spellcheck = false;\r\n    itemNameInput.classList.add(\"itemNameInput\");\r\n    itemNameInput.style.display = \"block\";\r\n    itemNameInput.style.marginTop = \".5em\";\r\n    itemNameInput.style.marginBottom = \".5em\";\r\n    return itemNameInput;\r\n}\r\n\r\nfunction createErrorMessage(target, message) {\r\n    // console.log('TCL: createErrorMessage -> target', target);\r\n    // console.log('TCL: createErrorMessage -> typeof target', typeof target);\r\n    // delete all previous error message\r\n    document.querySelectorAll(\".error\").forEach(\r\n        el => {\r\n            el.remove();\r\n        }\r\n    )\r\n    const popup = document.createElement(\"span\");\r\n    popup.innerHTML = message;\r\n    popup.classList.add(\"error\");\r\n    target.addEventListener(\"input\", () => {\r\n        popup.remove(); // delete itself when new input appears\r\n    });\r\n    insertAfter(target, popup);\r\n}\r\n\r\nfunction storeNewItem(itemNameInput, type, position) {\r\n    console.log('TCL: storeNewItem -> storeNewItem');\r\n    // store new item with the inputed name\r\n    const itemInfo = {\r\n        \"position\": position,\r\n        \"type\": type\r\n    };\r\n    const itemName = `${position}/${itemNameInput.value}`;\r\n    console.log('TCL: storeNewItem -> itemName', itemName);\r\n    setItemInStorage(itemName, itemInfo);\r\n    switch (type) {\r\n        case \"file\":\r\n            openFileEditField(itemName, itemInfo);\r\n            break;\r\n        case \"equation\":\r\n            openEquationEditField(itemName, itemInfo);\r\n            break;\r\n    }\r\n    return itemName;\r\n}\r\n\r\n// remove all labels of items and delete them in current item name list\r\n// DOES NOT REMOVE FROM STORAGE!!!\r\nfunction clearAllItems() {\r\n    removeAllChildren(system); // delete all children in system div\r\n    itemNameList.length = 0; // clear the current item list\r\n}\r\n\r\nfunction appendPosition(newPosition) {\r\n    setPosition(`${position}/${newPosition}`);\r\n}\r\n\r\n// set the current position (folder)\r\nfunction setPosition(newPosition) {\r\n    position = newPosition;\r\n    clearAllItems();\r\n    updateAtPosition(newPosition);\r\n    displayNavigationBar();\r\n    displayItemPlaceholder();\r\n}\r\n\r\n// retrieve the item name from its full position path\r\n// e.g. itemName = \"home/folder1/file1\"\r\n// returns \"file1\"\r\nfunction getEndOfPosition(itemName) {\r\n    return itemName.substring(itemName.lastIndexOf(\"/\") + 1);\r\n}\r\n\r\n// retrieve the item folder name from its full position path\r\n// e.g. itemName = \"home/folder1/file1\"\r\n// returns \"home/folder1\"\r\nfunction getStartOfPosition(itemName) {\r\n    return itemName.substring(0, itemName.lastIndexOf(\"/\"));\r\n}\r\n\r\n// display item labels\r\nfunction displayItem(itemName, itemType, itemPosition) {\r\n    // replace input with label\r\n    const itemLabel = document.createElement(\"p\");\r\n    const itemInfo = getItemFromStorage(itemName);\r\n    const displayedName = getEndOfPosition(itemName);\r\n    let itemLabelText = \"\";\r\n    if (itemType === \"file\") {\r\n        itemLabelText = `üìù`;\r\n    } else if (itemType === \"folder\") {\r\n        itemLabelText = `üìÅ`;\r\n    } else {\r\n        itemLabelText = `<i class=\"far fa-calculator\"></i>`;\r\n    }\r\n\r\n    // append item name\r\n    itemLabelText += displayedName;\r\n\r\n    // add link sign to indicate that the item is linked with another\r\n    if (itemInfo && itemInfo.link) {\r\n        itemLabelText += `<i class=\"far fa-link\"></i>`;\r\n    }\r\n\r\n    itemLabel.innerHTML = itemLabelText;\r\n\r\n    itemLabel.classList.add(itemType);\r\n    itemLabel.classList.add(\"btn\");\r\n    itemLabel.classList.add(\"item\");\r\n    itemLabel.setAttribute(\"data-name\", itemName);\r\n    itemLabel.addEventListener(\"click\", () => {\r\n        const editField = document.getElementById(\"editField\");\r\n        if (editField) { // has previous item's editor open\r\n            const previousItemName = editField.getAttribute(\"data-item\");\r\n            storeItem(previousItemName);\r\n        }\r\n        if (itemType === \"file\") {\r\n            displayFile(itemLabel, itemName, itemInfo);\r\n        } else if (itemType === \"folder\") {\r\n            // set item location to the folder\r\n            // console.log('TCL: displayItem -> position', position);\r\n            if (getItemFromStorage(itemName)) {\r\n                setPosition(itemName);\r\n            } else {\r\n                appendPosition(itemName);\r\n            }\r\n            // console.log('TCL: displayItem -> position', position);\r\n        } else if (itemType === \"equation\") {\r\n            displayEquation(itemLabel, itemName, itemInfo);\r\n        }\r\n    });\r\n    // console.log(\"displaying item...\");\r\n    if (itemPosition) {\r\n        // console.log('TCL: displayItem -> position', itemPosition);\r\n        insertAfter(itemPosition, itemLabel);\r\n    } else {\r\n        system.appendChild(itemLabel);\r\n    }\r\n}\r\n\r\nfunction storeItem(itemName) {\r\n    console.log('TCL: storeItem -> itemName', itemName);\r\n    const item = getItemFromStorage(itemName);\r\n    console.log('TCL: storeItem -> item', item);\r\n    if (item) { // item exists\r\n        const itemType = item.type;\r\n        console.log('TCL: storeItem -> itemType', itemType);\r\n        switch (itemType) {\r\n            case \"file\":\r\n                storeFile(itemName, item);\r\n                break;\r\n            case \"equation\":\r\n                storeEquation(itemName, item);\r\n                break;\r\n        }\r\n    }\r\n}\r\n\r\nfunction createFileEditor(id) {\r\n    const editor = document.createElement(\"textarea\");\r\n    if (id) {\r\n        editor.id = id;\r\n    } else {\r\n        editor.id = \"editor\";\r\n    }\r\n    editor.classList.add(\"editor\");\r\n    editor.setAttribute(\"data-type\", \"file\");\r\n    editor.rows = rowLength;\r\n    // NOTE: cols are one character bigger than actual calculator's\r\n    // line lengths because that's the space for vertical scroll bar\r\n    editor.cols = lineLength + 1;\r\n    editor.spellcheck = false;\r\n    return editor;\r\n}\r\n\r\nfunction displayFile(position, fileName, fileInfo) {\r\n    // toggle file editor\r\n    const editField = document.getElementById(\"editField\");\r\n    if (editField) {\r\n        editField.remove();\r\n        const clickedItemName = editField.getAttribute(\"data-item\");\r\n        if (clickedItemName !== fileName) { // not the same file\r\n            displayFile(position, fileName, fileInfo);\r\n        }\r\n    } else {\r\n        openFileEditField(fileName, fileInfo, position);\r\n    }\r\n}\r\n\r\nfunction deleteItem(itemLabel) {\r\n    const itemName = itemLabel.getAttribute(\"data-name\");\r\n    // remove item in storage\r\n    if (itemName) {\r\n        removeItemFromStorage(itemName);\r\n        removeElementInArray(itemNameList, itemName);\r\n        removeLink(itemName);\r\n    }\r\n    // remove item label\r\n    itemLabel.remove();\r\n    // remove associated edit field\r\n    const editField = document.getElementById(\"editField\");\r\n    if (editField && editField.getAttribute(\"data-item\") === itemName) {\r\n        editField.remove();\r\n    }\r\n}\r\n\r\nfunction removeLink(linkedItemName) {\r\n    iterateStorage(function (item, itemName) {\r\n        const itemLink = item.link;\r\n        if (itemLink === linkedItemName) {\r\n            delete item.link;\r\n            setItemInStorage(itemName, item);\r\n        }\r\n    })\r\n}\r\n\r\nfunction renameItem(itemLabel) {\r\n    const oldItemName = itemLabel.getAttribute(\"data-name\");\r\n    if (oldItemName) {\r\n        const item = getItemFromStorage(oldItemName);\r\n        const type = item.type;\r\n        const itemNameInput = createItemNameInput();\r\n        itemNameInput.value = getEndOfPosition(oldItemName);\r\n        insertAfter(itemLabel, itemNameInput);\r\n        itemNameInput.focus();\r\n        // console.log('TCL: renameItem -> itemLabel', itemLabel);\r\n        // console.log('TCL: renameItem -> itemLabel.parentNode', itemLabel.parentNode);\r\n        itemLabel.remove();\r\n        itemNameInput.addEventListener(\"keypress\", (e) => {\r\n            if (e.keyCode == 13) { // ENTER key\r\n                const newItemName = getFullItemName(itemNameInput.value);\r\n                if (itemNameList.indexOf(newItemName) >= 0 && newItemName !== oldItemName) { // repeated name\r\n                    createErrorMessage(itemNameInput,\r\n                        `Duplicated ${type} name, ${type} name must be unique`);\r\n                } else {\r\n                    replaceElementInArray(itemNameList, oldItemName, newItemName);\r\n                    renameItemInStorage(oldItemName, newItemName);\r\n                    displayItem(newItemName, type, itemNameInput);\r\n                    // remove item name input\r\n                    itemNameInput.remove();\r\n                }\r\n            }\r\n        })\r\n    }\r\n}\r\n\r\nfunction pinToHome(itemLabel) {\r\n    const originalItemName = itemLabel.getAttribute(\"data-name\");\r\n    const originalItemType = getItemFromStorage(originalItemName).type;\r\n    console.log('TCL: pinToHome -> itemName', originalItemName);\r\n    swal({\r\n            title: \"Give the pinned item a name\",\r\n            buttons: {\r\n                sameName: {\r\n                    text: \"Same Name\",\r\n                    value: \"sameName\",\r\n                },\r\n                newName: {\r\n                    text: \"New Name\",\r\n                    value: \"newName\",\r\n                },\r\n                cancel: \"Cancel\",\r\n            },\r\n        })\r\n        .then((value) => {\r\n            switch (value) {\r\n                case \"sameName\":\r\n                    swal(\"Pinned to home!\", {\r\n                        icon: \"success\",\r\n                        buttons: false,\r\n                        timer: 800,\r\n                    });\r\n                    linkItemToHome(originalItemName);\r\n                    break;\r\n\r\n                case \"newName\":\r\n                    askForNewLinkedName(originalItemName, originalItemType);\r\n                    break;\r\n            }\r\n        });\r\n}\r\n\r\nfunction askForNewLinkedName(originalItemName, originalItemType) {\r\n    swal({\r\n            title: \"Enter New Name: \",\r\n            content: {\r\n                element: \"input\",\r\n                attributes: {\r\n                    type: \"text\",\r\n                    maxLength: lineLength,\r\n                },\r\n            },\r\n        })\r\n        .then((newItemName) => {\r\n            console.log('TCL: askForNewLinkedName -> newItemName', newItemName);\r\n            swal(`${newItemName} pinned to home!`, {\r\n                icon: \"success\",\r\n                buttons: false,\r\n                timer: 800,\r\n            });\r\n            linkItemToHome(originalItemName, newItemName);\r\n        });\r\n}\r\n\r\nfunction linkItemToHome(originalItemName, shortlinkedItemName) {\r\n    console.log('TCL: linkItemToHome -> shortlinkedItemName', shortlinkedItemName);\r\n    const originalItem = getItemFromStorage(originalItemName);\r\n    console.log('TCL: linkItemToHome -> originalItem', originalItem);\r\n    if (shortlinkedItemName === undefined) {\r\n        shortlinkedItemName = getEndOfPosition(originalItemName);\r\n    }\r\n    const linkedItemName = `home/${shortlinkedItemName}`;\r\n    console.log('TCL: pinToHome -> newItemName', linkedItemName);\r\n    const itemNameList = getItemNamesAtPosition(homePosition);\r\n    if (itemNameList.indexOf(linkedItemName) >= 0 || shortlinkedItemName === \"\") {\r\n        let alertTitle = \"Duplicated Item Name!\";\r\n        console.log('TCL: linkItemToHome -> shortlinkedItemName', shortlinkedItemName);\r\n        if (shortlinkedItemName === \"\") { // empty name\r\n            alertTitle = \"Item name cannot be empty!\";\r\n        }\r\n        // duplicated name at home\r\n        swal({\r\n            title: alertTitle,\r\n            icon: \"warning\",\r\n            button: \"OK\",\r\n        }).then(() => {\r\n            // Ask for new item name\r\n            askForNewLinkedName(originalItemName, shortlinkedItemName);\r\n        });\r\n        throw new Error(\"Invalid item name\"); // stop program execution\r\n    }\r\n    console.log(\"linking the items...\");\r\n    const linkedItem = clone(originalItem); // must clone to not modify original\r\n    console.log('TCL: linkItemToHome -> linkedItem', linkedItem);\r\n    // set position to home\r\n    linkedItem.position = homePosition;\r\n    linkedItem.link = originalItemName;\r\n    console.log('TCL: linkItemToHome -> linkedItem', linkedItem);\r\n    // store linked item at home position\r\n    setItemInStorage(linkedItemName, linkedItem);\r\n    // modify original item\r\n    originalItem.link = linkedItemName;\r\n    setItemInStorage(originalItemName, originalItem);\r\n    // add link sign by updating current position\r\n    setPosition(position);\r\n}\r\n\r\nfunction getItemNamesAtPosition(position) {\r\n    const itemNameList = [];\r\n    iterateStorage(function (item, itemName) {\r\n        if (item.position === position) {\r\n            itemNameList.push(itemName);\r\n        }\r\n    });\r\n    return itemNameList;\r\n}\r\n\r\nfunction restrictContextItems(itemLabel) {\r\n    const pinToHomeBtn = document.querySelector(`li.context-menu__item[data-action=\"pinToHome\"`);\r\n    const itemName = itemLabel.getAttribute(\"data-name\");\r\n    const itemType = getItemFromStorage(itemName).type;\r\n    if (pinToHomeBtn) {\r\n        if (position === homePosition || itemType === \"folder\") {\r\n            pinToHomeBtn.style.display = \"none\";\r\n        } else {\r\n            pinToHomeBtn.style.display = \"block\";\r\n        }\r\n    }\r\n}\r\n\r\nfunction renameItemInStorage(oldItemName, newItemName) {\r\n    const item = getItemFromStorage(oldItemName);\r\n    removeItemFromStorage(oldItemName);\r\n    setItemInStorage(newItemName, item);\r\n}\r\n\r\nfunction removeItemFromStorage(itemName) {\r\n    localStorage.removeItem(itemName);\r\n}\r\n\r\nfunction getItemFromStorage(itemName) {\r\n    return JSON.parse(localStorage.getItem(itemName));\r\n}\r\n\r\nfunction setItemInStorage(itemName, item) {\r\n    // store item itself\r\n    localStorage.setItem(itemName, JSON.stringify(item));\r\n    // update linked item\r\n    if (item.link) {\r\n        const linkedItemName = item.link;\r\n        const linkedItem = clone(item);\r\n        linkedItem.position = getStartOfPosition(linkedItemName);\r\n        linkedItem.link = itemName;\r\n        localStorage.setItem(linkedItemName, JSON.stringify(linkedItem));\r\n    }\r\n}\r\n\r\nfunction convertWordsToSymbols(str) {\r\n    for (const [key, value] of Object.entries(conversionTable)) {\r\n        str = str.replace(new RegExp(RegExp.escape(\"\\\\\" + key), \"g\"), value);\r\n    }\r\n    return str;\r\n}\r\n\r\nfunction convertSymbolsToWords(str) {\r\n    for (const [key, value] of Object.entries(conversionTable)) {\r\n        str = str.replace(new RegExp(RegExp.escape(value), \"g\"), \"\\\\\" + key);\r\n    }\r\n    return str;\r\n}\r\n\r\nfunction convertSingleQuotesToDoubleQuotes(str) {\r\n    return str.replace(new RegExp(`'`, \"g\"), `\"`);\r\n}\r\n\r\nfunction convertDoubleQuotesToSingleQuotes(str) {\r\n    return str.replace(new RegExp(`\"`, \"g\"), `'`);\r\n}\r\n\r\nfunction decodeFileContent(fileContent) {\r\n    let content = convertSpacesToNewlines(fileContent);\r\n    content = convertWordsToSymbols(content);\r\n    content = convertSingleQuotesToDoubleQuotes(content);\r\n    return content;\r\n}\r\n\r\nfunction encodeFileContent(fileContent) {\r\n    let content = convertNewlinesToSpaces(fileContent);\r\n    // double quotes cannot be in TI-BASIC's strings\r\n    content = convertDoubleQuotesToSingleQuotes(content);\r\n    return content;\r\n}\r\n\r\nfunction convertToUppercase(str) {\r\n    let result = \"\";\r\n    for (let i = 0; i < str.length; i++) {\r\n        const char = str[i];\r\n        if (/^[a-zA-Z]*$/.test(char)) {\r\n            result += char.toUpperCase();\r\n        } else {\r\n            result += char;\r\n        }\r\n    }\r\n    return result;\r\n}\r\n\r\nfunction openFileEditField(itemName, itemInfo, position) {\r\n    const editor = createFileEditor();\r\n    editor.placeholder = \"Write notes here\"\r\n    toUppercase = defaultToUppercase; // reset uppercase setting\r\n    if (itemInfo.content !== undefined) {\r\n        editor.value = decodeFileContent(itemInfo.content);\r\n        editor.setAttribute(\"data-item\", itemName);\r\n        if (/[a-z]+/.test(editor.value)) { // contains lowercase\r\n            // turn off to uppercase\r\n            toUppercase = false;\r\n        }\r\n    }\r\n    editor.addEventListener(\"input\", () => {\r\n        let content = editor.value;\r\n        // content conversion\r\n        content = convertWordsToSymbols(content);\r\n        if (toUppercase && content.indexOf(\"\\\\\") < 0) {\r\n            content = convertToUppercase(content);\r\n        }\r\n\r\n        // update file size label\r\n        updateItemSize(itemName, content);\r\n\r\n        // console.log('TCL: openFileEditField -> content', content);\r\n        // pasting in more than one line of content\r\n        if (content.length - lastFileContent.length > lineLength) {\r\n            let start = lastFileContent.lastIndexOf(\"\\n\");\r\n            for (let end = 0; end < content.length; end++) {\r\n                if (end - start === lineLength) {\r\n                    content = insertSubstring(content, end + 1, \"\\n\");\r\n                    end++; // move to the newly inserted \"\\n\"\r\n                    start = end;\r\n                }\r\n            }\r\n        } else if (content.length >= lastFileContent.length) { // typing individual characters\r\n            const lastLineLength = content.length - content.lastIndexOf(\"\\n\") - 1;\r\n            // console.log('TCL: openFileEditField -> lastLineLength', lastLineLength);\r\n            if (lastLineLength > lineLength) {\r\n                content = insertSubstring(content, content.length - 1, \"\\n\", 0); // avoid word wrapping\r\n            }\r\n            // console.log('TCL: openFileEditField -> content.length', content.length);\r\n        } else { // deleting contents\r\n            // const cursorPosition = editor.selectionStart;\r\n            // console.log('TCL: openFileEditField -> cursorPosition', cursorPosition);\r\n            // let previousNewline = content.substring(0, cursorPosition)\r\n            //     .lastIndexOf(\"\\n\");\r\n            // console.log('TCL: openFileEditField -> previousNewline', previousNewline)\r\n            // const nextNewline = content.indexOf(\"\\n\", cursorPosition);\r\n            // if (previousNewline === -1){\r\n            //     previousNewline = 0;\r\n            // }\r\n            // console.log('TCL: openFileEditField -> nextNewline', nextNewline);\r\n            // if (nextNewline - previousNewline < lineLength){\r\n            //     content = deleteSubstring(content, nextNewline, 1);\r\n            //     content = insertSubstring(content, previousNewline + lineLength, \"\\n\");\r\n            // }\r\n        }\r\n        editor.value = content;\r\n        lastFileContent = content;\r\n    });\r\n\r\n    const controlDiv = document.createElement(\"div\");\r\n    controlDiv.id = \"editFieldControl\";\r\n\r\n    const submitBtn = document.createElement(\"span\");\r\n    submitBtn.id = \"submitFileBtn\";\r\n    submitBtn.classList.add(\"btn\");\r\n    submitBtn.innerHTML = \"Submit\";\r\n    submitBtn.addEventListener(\"click\", () => {\r\n        storeFile(itemName, itemInfo);\r\n        editField.remove();\r\n    });\r\n    Mousetrap(editor).bind('mod+s', function (e, combo) {\r\n        submitBtn.click();\r\n        return false; // prevent event's default behavior\r\n    });\r\n    const editField = document.createElement(\"div\");\r\n    editField.id = \"editField\";\r\n    editField.setAttribute(\"data-item\", itemName);\r\n    if (position === undefined) {\r\n        system.appendChild(editField);\r\n    } else {\r\n        insertAfter(position, editField);\r\n    }\r\n    editField.appendChild(editor);\r\n    editField.appendChild(controlDiv);\r\n    controlDiv.appendChild(submitBtn);\r\n\r\n    // add uppercase checkbox and info button\r\n    controlDiv.insertAdjacentHTML(\"beforeend\",\r\n        `<div id=\"uppercaseDiv\">\r\n            <input type=\"checkbox\" id=\"uppercaseCheckBox\">\r\n            <label for=\"uppercaseCheckBox\">Uppercase</label>\r\n            <i class=\"far fa-info-circle infoBtn\" id=\"uppercaseInfoBtn\"></i>\r\n        </div>`);\r\n    const uppercaseCheckBox = document.getElementById(\"uppercaseCheckBox\");\r\n    uppercaseCheckBox.checked = toUppercase;\r\n    uppercaseCheckBox.addEventListener(\"change\", () => {\r\n        if (uppercaseCheckBox.checked !== toUppercase) {\r\n            toUppercase = uppercaseCheckBox.checked;\r\n            editor.value = convertToUppercase(editor.value);\r\n        }\r\n    });\r\n    const uppercaseInfoBtn = document.getElementById(\"uppercaseInfoBtn\");\r\n    uppercaseInfoBtn.addEventListener(\"click\", () => {\r\n        swal({\r\n            title: \"Why does the text need to be in uppercase?\",\r\n            text: `1. Some lowercase words are predefined as keywords, like \"and\", \"sin(\", etc. in TI. Thus, their length cannot be accurately determined because keywords all occupy one space in TI. This can mess up note layout and hide some parts of the note. \r\n            2. Uppercase letters (1 byte each) take up less spaces than lowercase letters (2 bytes each).\r\n            Sugguestion: You should stick with uppercase in all your notes.`,\r\n            buttons: \"okay\",\r\n        });\r\n    });\r\n    editor.focus();\r\n}\r\n\r\nfunction storeFile(itemName, itemInfo) {\r\n    let content = document.getElementById(\"editor\").value;\r\n    console.log('TCL: storeFile -> content', content);\r\n    content = encodeFileContent(content);\r\n    itemInfo.content = content;\r\n    setItemInStorage(itemName, itemInfo);\r\n    // update file size\r\n    updateItemSize(itemName, content);\r\n}\r\n\r\nfunction updateItemSize(itemName, content) {\r\n    const fileLabel = document.querySelector(`p[data-name=\"${itemName}\"]`);\r\n    const size = countItemSize(itemName, content);\r\n    // console.log('TCL: updateFileSize -> size', size);\r\n    // remove previous label\r\n    const sizeString = `${size} bits`;\r\n    const sizeLabel = fileLabel.getElementsByClassName(\"sizeLabel\");\r\n    if (sizeLabel[0]) {\r\n        sizeLabel[0].innerHTML = sizeString;\r\n    } else {\r\n        fileLabel.insertAdjacentHTML(\"beforeend\",\r\n            `<span style=\"float:right;\" class=\"sizeLabel\">${sizeString}</span>`);\r\n    }\r\n}\r\n\r\nfunction countItemSize(itemName, content) {\r\n    const item = getItemFromStorage(itemName);\r\n    if (content === undefined) {\r\n        content = item.content;\r\n    }\r\n    if (item.type === \"file\") {\r\n        return countFileSize(content);\r\n    } else {\r\n        return countFolderSize(itemName);\r\n    }\r\n}\r\n\r\nfunction countFolderSize(folderName) {\r\n    let size = 0;\r\n    iterateStorage(function (item, itemName, itemType, itemPosition, index) {\r\n        if (itemPosition === folderName) {\r\n            if (itemType === \"file\") {\r\n                size += countFileSize(item.content);\r\n            } else {\r\n                size += countFolderSize(itemName);\r\n            }\r\n        }\r\n    });\r\n    return size;\r\n}\r\n\r\nfunction countFileSize(content) {\r\n    let size = 0;\r\n    if (content) { // content exists\r\n        for (let i = 0; i < content.length; i++) {\r\n            const char = content[i];\r\n            // one-byte characters\r\n            if (/[0-9A-Z{}()[\\],.!?+\\-*\\/^:=<>‚â§‚â•‚â†œÄ‚àö ]/.test(char)) {\r\n                size += 1;\r\n            } else { // all other symbols are two-bytes\r\n                size += 2;\r\n            }\r\n        }\r\n    }\r\n    return size * 8; // convert bytes to bits\r\n}\r\n\r\nfunction convertNewlinesToSpaces(inputStr) {\r\n    let str = inputStr;\r\n    let previousNewlineIndex = 0;\r\n    let newlineIndex = str.indexOf(\"\\n\");\r\n    // substitute newlines with spaces\r\n    while (newlineIndex >= 0 && previousNewlineIndex < str.length) {\r\n        newlineIndex = str.indexOf(\"\\n\", previousNewlineIndex);\r\n        if (newlineIndex < 0) {\r\n            break;\r\n        }\r\n        console.log('newlineIndex:' + newlineIndex);\r\n        const numOfSpaces = lineLength - (newlineIndex - previousNewlineIndex);\r\n        let spaces = \"\";\r\n        for (let i = 0; i < numOfSpaces; i++) {\r\n            spaces += \" \";\r\n        }\r\n        str = str.slice(0, newlineIndex) + spaces + str.slice(newlineIndex + 1);\r\n        // str = insertString(str, newlineIndex, spaces, 1);\r\n        console.log(\"str: \" + str);\r\n        previousNewlineIndex = newlineIndex + numOfSpaces;\r\n        console.log(\"previousNewlineIndex: \" + previousNewlineIndex)\r\n    }\r\n    return str;\r\n}\r\n\r\nfunction convertSpacesToNewlines(inputStr) {\r\n    let str = inputStr;\r\n    let index = lineLength - 1;\r\n    while (index < str.length) {\r\n        if (str[index] === \" \") {\r\n            str = deleteSubstring(str, index, 1);\r\n            index--;\r\n        } else {\r\n            str = insertSubstring(str, index + 1, \"\\n\", 0);\r\n            index += lineLength + 1;\r\n        }\r\n    }\r\n    return str;\r\n}"]}